
<#assign className = table.className>
<#assign classNameLower =
className?uncap_first>
<#assign leftbit = "#{">
<#assign rightbit = "}">
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="${basepackage}.common.pojo.${classNameLower}Mapper">

	<resultMap id="${classNameLower}ResultMap" type="${basepackage}.common.pojo.${className}">
		<@generateResultMap/>
	</resultMap>

	<!--根据ID获取对象 -->
	<select id="get${className}ById" parameterType="map"
		resultMap="${classNameLower}ResultMap">
        <![CDATA[
               SELECT * FROM ${table.sqlName} WHERE ID=${leftbit}id${rightbit}
        ]]>
	</select>

	<!--分页获取对象 -->
	<select id="get${className}Page" parameterType="map"
		resultMap="${classNameLower}ResultMap">
    	<![CDATA[
               SELECT TSPI.* FROM ${table.sqlName} TSPI
               WHERE 1=1
        ]]>
		<@generateQueryWhere/>
	</select>

    <#if noparent == "0"||noparent == "2">
	<!--根据ID删除对象 -->
	<delete id="delete${className}ById" parameterType="map">
        <![CDATA[
               DELETE FROM ${table.sqlName} WHERE ID=${leftbit}id${rightbit}
        ]]>
	</delete>

	<!--修改对象 -->
	<update id="update${className}" parameterType="map">
        <![CDATA[
              UPDATE ${table.sqlName}
              SET 
              <@generateUpdate/>
              WHERE ID=${leftbit}id${rightbit}
        ]]>

	</update>

    <!--保存对象 -->
	<insert id="save${className}" parameterType="map">
		INSERT INTO ${table.sqlName} (
		ID
		<@generateSave/>
	</insert>
    </#if>

</mapper>
<#macro generateResultMap>
<#list table.columns as column>
<result property="${column.columnNameLower}" column="${column.sqlName}" />
</#list>
</#macro>
<#macro generateQueryWhere>
<#list table.columns as
column>
<if test="${column.columnNameLower}!=null and ${column.columnNameLower}!=''">
		    <![CDATA[ AND TSPI.${column.sqlName} = ${leftbit}${column.columnNameLower}${rightbit} ]]>
</if>
</#list>
</#macro>

<#macro generateUpdate>
<#list table.columns as column>
<#if table.columns?size!=(column_index+1) && !column.pk>
							${column.sqlName} = ${leftbit}${column.columnNameLower}${rightbit},
</#if>
<#if table.columns?size==(column_index+1)>
							${column.sqlName} = ${leftbit}${column.columnNameLower}${rightbit}
</#if>
</#list>
</#macro>

<#macro generateSave>
<#list table.columns as column>
<#if !column.pk>
		<if test="${column.columnNameLower}!=null and ${column.columnNameLower}!=''">
			,${column.sqlName}
		</if>
</#if>
</#list>
		) VALUES (
${leftbit}id${rightbit}
<#list table.columns as column>
<#if !column.pk>
		<if test="${column.columnNameLower}!=null and ${column.columnNameLower}!=''">
			,${leftbit}${column.columnNameLower}${rightbit}
		</if>
</#if>
</#list>
		)
</#macro>
